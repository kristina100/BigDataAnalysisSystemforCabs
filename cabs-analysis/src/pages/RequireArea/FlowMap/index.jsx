import React, { Component } from 'react'

export default class FlowMap extends Component {

  componentDidMount() {
    const map = new window.AMap.Map(this.refs.container, {
      viewMode: '2D',
      resizeEnable: true, // 是否监控地图容器尺寸变化
      zoom: 12, // 初始化地图层级
      center: [113.2247, 23.1304], // 初始化地图中心点
      mapStyle: 'amap://styles/whitesmoke'
    });

    var loca = new window.Loca.Container({
      map,
    });

    // 颜色配置
    var headColors = ['#ECFFB1', '#146968', '#00b3a9', '#03a19b', '#146442', '#147568', '#149968', '#116968'];
    var trailColors = [
      'rgba(255,178,6, 0.2)',
      'rgba(255,178,6, 0.2)',
      'rgba(0, 179, 169, 0.1)',
      'rgba(20,105,104, 0.2)',
      'rgba(20,105,104, 0.2)',
      'rgba(20,105,104, 0.2)',
      'rgba(20,105,104, 0.2)',
      'rgba(20,105,104, 0.2)',
    ];

    let finalLine = [],
      finalSpot = [];
    // 测试用起点和终点
    let allLine = [[[113.291652, 23.144546], [113.290439, 23.14191]], [[113.290781, 23.128104], [113.294472, 23.132676]], [[113.289673, 23.131641], [113.290792, 23.131272]], [[113.292266, 23.126972], [113.293442, 23.128195]], [[113.288225, 23.13446], [113.298261, 23.143666]], [[113.288908, 23.13655], [113.291737, 23.140614]], [[113.286387, 23.133774], [113.291388, 23.130778]], [[113.290547, 23.133036], [113.287814, 23.133486]], [[113.294586, 23.134274], [113.286041, 23.128299]], [[113.286992, 23.135201], [113.292694, 23.131887]], [[113.280013, 23.131133], [113.292636, 23.126623]], [[113.293706, 23.135921], [113.2922, 23.131137]], [[113.286085, 23.135336], [113.287831, 23.131356]], [[113.290691, 23.128649], [113.287121, 23.129136]], [[113.281423, 23.140008], [113.277895, 23.13877]], [[113.29304, 23.136173], [113.296845, 23.134113]], [[113.287207, 23.137537], [113.287629, 23.142724]], [[113.281388, 23.128467], [113.285065, 23.131062]], [[113.291497, 23.128436], [113.29188, 23.13088]], [[113.28725, 23.136473], [113.283807, 23.136017]], [[113.281449, 23.134111], [113.272174, 23.131936]], [[113.293043, 23.143065], [113.291203, 23.138349]], [[113.289807, 23.145467], [113.289749, 23.128472]], [[113.291199, 23.139274], [113.296543, 23.14228]], [[113.293297, 23.129098], [113.293812, 23.140195]], [[113.288675, 23.129159], [113.291715, 23.12471]], [[113.275751, 23.134909], [113.282777, 23.130794]], [[113.283891, 23.132106], [113.286336, 23.135637]], [[113.285903, 23.12784], [113.284158, 23.129915]], [[113.283599, 23.130509], [113.286172, 23.13367]], [[113.294205, 23.131612], [113.29417, 23.133464]], [[113.291615, 23.143727], [113.294555, 23.13099]], [[113.289364, 23.132859], [113.291804, 23.134221]], [[113.285557, 23.128641], [113.285873, 23.131169]], [[113.291669, 23.139871], [113.293793, 23.1246]], [[113.291222, 23.134011], [113.292592, 23.137837]], [[113.293235, 23.129699], [113.296377, 23.12855]], [[113.292972, 23.137439], [113.290254, 23.137385]], [[113.290509, 23.130197], [113.29124, 23.134584]], [[113.291128, 23.138325], [113.294636, 23.131757]], [[113.288911, 23.128997], [113.29175, 23.134731]], [[113.290634, 23.136683], [113.293631, 23.139402]], [[113.28909, 23.131796], [113.294843, 23.140628]], [[113.283055, 23.130885], [113.291072, 23.12876]], [[113.30052, 23.133642], [113.300958, 23.137581]], [[113.283149, 23.133372], [113.284798, 23.136308]], [[113.293862, 23.132252], [113.293387, 23.132739]], [[113.286199, 23.132925], [113.289805, 23.131063]], [[113.288862, 23.124303], [113.288794, 23.126152]], [[113.28558, 23.130648], [113.288803, 23.134236]], [[113.284953, 23.13914], [113.29093, 23.131596]], [[113.285127, 23.127936], [113.28502, 23.129472]], [[113.289167, 23.127648], [113.296926, 23.131447]], [[113.303727, 23.134833], [113.309435, 23.13241]], [[113.286461, 23.138388], [113.280282, 23.140177]], [[113.287162, 23.136159], [113.283627, 23.143684]], [[113.288586, 23.129511], [113.289326, 23.1293]], [[113.290501, 23.134689], [113.290277, 23.129208]], [[113.291282, 23.135947], [113.293364, 23.131373]], [[113.287872, 23.127651], [113.292119, 23.133154]], [[113.293745, 23.13853], [113.300629, 23.132549]], [[113.293407, 23.133902], [113.301315, 23.137084]], [[113.279008, 23.134235], [113.293701, 23.123424]], [[113.287903, 23.130271], [113.294037, 23.128296]], [[113.285275, 23.133377], [113.29264, 23.129185]], [[113.293402, 23.131024], [113.298697, 23.132903]], [[113.292884, 23.131685], [113.292663, 23.133473]], [[113.28714, 23.143865], [113.291848, 23.14498]], [[113.295453, 23.135961], [113.294232, 23.127004]], [[113.288614, 23.133486], [113.283167, 23.127087]], [[113.288843, 23.126714], [113.292222, 23.12914]], [[113.2925, 23.132166], [113.295406, 23.12716]], [[113.288655, 23.140546], [113.291571, 23.134311]], [[113.290732, 23.138131], [113.288982, 23.134057]], [[113.282596, 23.131232], [113.29331, 23.130804]], [[113.273983, 23.132544], [113.280569, 23.134218]], [[113.289013, 23.139369], [113.292518, 23.126643]], [[113.286841, 23.134802], [113.282651, 23.132813]], [[113.291954, 23.128152], [113.292005, 23.12585]], [[113.295881, 23.137392], [113.291857, 23.1283]], [[113.29116, 23.136795], [113.29494, 23.135058]], [[113.286341, 23.134265], [113.291058, 23.135654]], [[113.291704, 23.135847], [113.296762, 23.142213]], [[113.298401, 23.130003], [113.293557, 23.127953]], [[113.287116, 23.129768], [113.294179, 23.136762]], [[113.277363, 23.131585], [113.283343, 23.133187]], [[113.284895, 23.13888], [113.289381, 23.134254]], [[113.290222, 23.133042], [113.287819, 23.13558]], [[113.298245, 23.129406], [113.297955, 23.126203]], [[113.293479, 23.127883], [113.298482, 23.133836]], [[113.283713, 23.141473], [113.290542, 23.138108]], [[113.28625, 23.135862], [113.294359, 23.13383]], [[113.29152, 23.14038], [113.285379, 23.136169]], [[113.291689, 23.141561], [113.297773, 23.135833]], [[113.284877, 23.127152], [113.290278, 23.134972]], [[113.296599, 23.13906], [113.298799, 23.137483]], [[113.289646, 23.127822], [113.294964, 23.133044]], [[113.287978, 23.13871], [113.288781, 23.134066]], [[113.284095, 23.133841], [113.283938, 23.132424]], [[113.286351, 23.134771], [113.293972, 23.134318]], [[113.289052, 23.132911], [113.292559, 23.12809]], [[113.288066, 23.134638], [113.287492, 23.137512]], [[113.290287, 23.141582], [113.284684, 23.138037]], [[113.285731, 23.130831], [113.286501, 23.131035]], [[113.292501, 23.138065], [113.292631, 23.14266]], [[113.286843, 23.134841], [113.285509, 23.130643]], [[113.289875, 23.131927], [113.290514, 23.133644]], [[113.285615, 23.128439], [113.294655, 23.126509]], [[113.287096, 23.135288], [113.295456, 23.130371]], [[113.288904, 23.131116], [113.29547, 23.131732]], [[113.277683, 23.131396], [113.28291, 23.137072]], [[113.292414, 23.132373], [113.295413, 23.122622]], [[113.284968, 23.128131], [113.288939, 23.132695]], [[113.277652, 23.133017], [113.289532, 23.126403]], [[113.289775, 23.133374], [113.284663, 23.139264]], [[113.29381, 23.139919], [113.295522, 23.147479]], [[113.286153, 23.138052], [113.293937, 23.135423]], [[113.290725, 23.13089], [113.288807, 23.13416]], [[113.286228, 23.136077], [113.292679, 23.139188]], [[113.279991, 23.133705], [113.28637, 23.131801]], [[113.28693, 23.126868], [113.289536, 23.133161]], [[113.287999, 23.12755], [113.291038, 23.134406]], [[113.295443, 23.12834], [113.291945, 23.137206]], [[113.286085, 23.137115], [113.287869, 23.129107]], [[113.288778, 23.133259], [113.288624, 23.136232]], [[113.282005, 23.142006], [113.285651, 23.141077]], [[113.285163, 23.132614], [113.288622, 23.13364]], [[113.288639, 23.132592], [113.292687, 23.128975]], [[113.29026, 23.139985], [113.290402, 23.135996]], [[113.289567, 23.133546], [113.291618, 23.134763]], [[113.295664, 23.137361], [113.302005, 23.131446]], [[113.281609, 23.142788], [113.287597, 23.134768]], [[113.283827, 23.132479], [113.2875, 23.134266]], [[113.282966, 23.137067], [113.279598, 23.130033]], [[113.280323, 23.131637], [113.285448, 23.128863]], [[113.278206, 23.127952], [113.284424, 23.130806]], [[113.297231, 23.127132], [113.290012, 23.126478]], [[113.279502, 23.134557], [113.285028, 23.129594]], [[113.290663, 23.133112], [113.296752, 23.134078]], [[113.275873, 23.127938], [113.276724, 23.13037]], [[113.291016, 23.134151], [113.296179, 23.130235]], [[113.286301, 23.126533], [113.28672, 23.129123]], [[113.290479, 23.132832], [113.298853, 23.128015]], [[113.288032, 23.130981], [113.288201, 23.138379]], [[113.281054, 23.129777], [113.282869, 23.139626]], [[113.293635, 23.126026], [113.296544, 23.123575]], [[113.283553, 23.131872], [113.28757, 23.135354]], [[113.292637, 23.131225], [113.28284, 23.131389]], [[113.291573, 23.139813], [113.288571, 23.136757]], [[113.285104, 23.121967], [113.293229, 23.130444]], [[113.285455, 23.125927], [113.281837, 23.139631]], [[113.285089, 23.142574], [113.291554, 23.131389]], [[113.283119, 23.133818], [113.284354, 23.132376]], [[113.290025, 23.135742], [113.297896, 23.126889]], [[113.292267, 23.130505], [113.29386, 23.131894]], [[113.287261, 23.130038], [113.292292, 23.134826]], [[113.291337, 23.138774], [113.292473, 23.133817]], [[113.279275, 23.136686], [113.285642, 23.134868]], [[113.286248, 23.139189], [113.289411, 23.130882]], [[113.28904, 23.13629], [113.292566, 23.127917]], [[113.284006, 23.129552], [113.289954, 23.136475]], [[113.290152, 23.129161], [113.288802, 23.127253]], [[113.280934, 23.141068], [113.285696, 23.141095]], [[113.281035, 23.13148], [113.285615, 23.128847]], [[113.292626, 23.131246], [113.28922, 23.1335]], [[113.285482, 23.125702], [113.293616, 23.123297]], [[113.291877, 23.136347], [113.28985, 23.136292]], [[113.287751, 23.13801], [113.288553, 23.142821]], [[113.282039, 23.127928], [113.28858, 23.132187]], [[113.290546, 23.138542], [113.288247, 23.131907]], [[113.289109, 23.12662], [113.292485, 23.13534]], [[113.287133, 23.134037], [113.290806, 23.12596]], [[113.289202, 23.129456], [113.289639, 23.1293]], [[113.282018, 23.130276], [113.288644, 23.132363]], [[113.282083, 23.129997], [113.288669, 23.135006]], [[113.288806, 23.137505], [113.293797, 23.136013]], [[113.29255, 23.125824], [113.296122, 23.127036]], [[113.292724, 23.129604], [113.292576, 23.128679]], [[113.28723, 23.13348], [113.292335, 23.137671]], [[113.280622, 23.136032], [113.289196, 23.137354]], [[113.290316, 23.135989], [113.290464, 23.142399]], [[113.288908, 23.128268], [113.291245, 23.137564]], [[113.282538, 23.132536], [113.284957, 23.13131]], [[113.283945, 23.138628], [113.293802, 23.138475]], [[113.290247, 23.129272], [113.294555, 23.12806]], [[113.289083, 23.134417], [113.295443, 23.13545]], [[113.289675, 23.130076], [113.284653, 23.131725]], [[113.288817, 23.130761], [113.2961, 23.127903]], [[113.28238, 23.121776], [113.28798, 23.126589]], [[113.289664, 23.133951], [113.293135, 23.136039]], [[113.288141, 23.137814], [113.288433, 23.133552]], [[113.290942, 23.119164], [113.294979, 23.120836]], [[113.291265, 23.133499], [113.294361, 23.129399]], [[113.28427, 23.137446], [113.287298, 23.146086]], [[113.280893, 23.134786], [113.280775, 23.131804]], [[113.282912, 23.126426], [113.278007, 23.123786]], [[113.285276, 23.130304], [113.290142, 23.127112]], [[113.292439, 23.130664], [113.300443, 23.130505]], [[113.293161, 23.132552], [113.292894, 23.125415]], [[113.290884, 23.127824], [113.287025, 23.12964]], [[113.28579, 23.13384], [113.280462, 23.125787]], [[113.285932, 23.137065], [113.288508, 23.130692]], [[113.287988, 23.143489], [113.292778, 23.137795]], [[113.291253, 23.132519], [113.298256, 23.137683]], [[113.281492, 23.123067], [113.291605, 23.12738]], [[113.292682, 23.121177], [113.297424, 23.133137]], [[113.289509, 23.122934], [113.286788, 23.128108]], [[113.281299, 23.134932], [113.282355, 23.128595]], [[113.288572, 23.139645], [113.290456, 23.136057]], [[113.27693, 23.135966], [113.281463, 23.124678]], [[113.281978, 23.13419], [113.291677, 23.137129]], [[113.287118, 23.136629], [113.287457, 23.138366]], [[113.286996, 23.125535], [113.30587, 23.120084]], [[113.291809, 23.139894], [113.295043, 23.133322]], [[113.281549, 23.133962], [113.282027, 23.130781]], [[113.278443, 23.125185], [113.276893, 23.129195]], [[113.289186, 23.135752], [113.283928, 23.132509]], [[113.282339, 23.133016], [113.290336, 23.128957]], [[113.285368, 23.134114], [113.289383, 23.134484]], [[113.287844, 23.138502], [113.296615, 23.135148]], [[113.286727, 23.131473], [113.286242, 23.12709]], [[113.290887, 23.138457], [113.29273, 23.143833]], [[113.279846, 23.131249], [113.278352, 23.136162]], [[113.288567, 23.137243], [113.289427, 23.137962]], [[113.285133, 23.129], [113.294431, 23.139543]], [[113.283808, 23.130774], [113.290546, 23.130645]], [[113.290589, 23.136647], [113.300091, 23.131395]], [[113.287765, 23.129039], [113.284415, 23.131152]], [[113.295225, 23.126539], [113.294515, 23.135968]], [[113.282244, 23.138017], [113.289917, 23.135526]], [[113.293722, 23.135274], [113.302436, 23.130473]], [[113.290308, 23.134005], [113.288166, 23.133592]], [[113.289946, 23.13816], [113.297279, 23.128683]], [[113.290373, 23.121664], [113.290131, 23.123679]], [[113.285558, 23.135981], [113.287981, 23.135735]], [[113.296978, 23.139321], [113.302994, 23.128617]], [[113.280673, 23.128947], [113.28188, 23.126214]], [[113.281372, 23.140442], [113.290656, 23.134602]], [[113.289172, 23.134333], [113.289711, 23.127664]], [[113.286214, 23.139319], [113.282497, 23.134653]], [[113.288452, 23.13135], [113.293891, 23.13604]], [[113.284705, 23.132702], [113.289671, 23.136571]], [[113.291509, 23.131602], [113.294534, 23.134438]], [[113.287844, 23.126713], [113.293832, 23.125311]], [[113.287052, 23.134817], [113.292784, 23.133166]], [[113.294349, 23.130211], [113.291396, 23.133526]], [[113.288141, 23.134991], [113.290402, 23.129482]], [[113.295715, 23.130483], [113.297772, 23.134626]], [[113.28976, 23.134275], [113.288455, 23.136065]], [[113.293746, 23.134884], [113.297967, 23.138794]], [[113.284531, 23.123796], [113.290417, 23.128307]], [[113.284717, 23.13861], [113.287445, 23.143821]], [[113.290951, 23.13558], [113.290051, 23.137916]], [[113.281621, 23.130403], [113.283803, 23.137505]], [[113.291449, 23.126383], [113.301497, 23.127058]], [[113.287485, 23.128406], [113.286255, 23.128155]], [[113.288791, 23.128735], [113.288579, 23.126108]], [[113.290292, 23.124669], [113.287623, 23.126816]], [[113.285751, 23.131314], [113.293049, 23.134169]], [[113.290041, 23.135655], [113.291871, 23.133673]], [[113.281267, 23.129619], [113.281762, 23.132365]], [[113.289448, 23.134522], [113.29203, 23.127059]], [[113.288106, 23.135824], [113.287262, 23.136364]], [[113.29625, 23.136714], [113.297778, 23.131542]], [[113.295575, 23.122035], [113.29708, 23.123787]], [[113.280446, 23.13498], [113.278694, 23.130541]], [[113.286294, 23.134318], [113.294345, 23.13511]], [[113.287128, 23.141393], [113.288761, 23.135452]], [[113.284635, 23.132697], [113.285197, 23.129785]], [[113.288001, 23.135647], [113.288551, 23.128421]], [[113.286865, 23.137844], [113.289565, 23.131746]], [[113.281713, 23.146946], [113.288097, 23.136411]], [[113.282801, 23.129674], [113.291365, 23.129906]], [[113.299937, 23.132183], [113.292849, 23.128289]], [[113.283125, 23.135954], [113.284007, 23.134011]], [[113.296498, 23.134094], [113.291236, 23.130398]], [[113.289247, 23.133107], [113.290648, 23.128605]], [[113.293132, 23.132051], [113.298923, 23.130467]], [[113.283519, 23.132131], [113.281293, 23.125456]], [[113.291191, 23.130494], [113.292212, 23.133841]], [[113.292931, 23.137792], [113.300701, 23.140734]], [[113.281265, 23.123974], [113.28693, 23.130046]], [[113.281189, 23.134236], [113.285638, 23.130287]], [[113.282913, 23.130396], [113.283897, 23.132059]], [[113.283665, 23.133948], [113.287584, 23.136337]], [[113.282693, 23.129746], [113.289039, 23.135383]], [[113.281977, 23.145792], [113.284502, 23.139914]], [[113.286533, 23.134765], [113.288521, 23.133576]], [[113.287216, 23.136382], [113.291085, 23.128555]], [[113.293282, 23.130311], [113.296982, 23.132829]], [[113.289118, 23.130227], [113.293871, 23.134715]], [[113.288974, 23.13581], [113.291661, 23.134058]], [[113.282397, 23.136722], [113.280862, 23.128537]], [[113.295774, 23.128907], [113.291357, 23.130891]], [[113.292204, 23.141797], [113.290979, 23.134691]], [[113.285001, 23.123824], [113.281251, 23.128959]], [[113.301003, 23.132414], [113.287147, 23.130516]], [[113.281986, 23.139273], [113.288289, 23.131727]], [[113.284162, 23.13988], [113.286273, 23.126907]], [[113.294393, 23.134088], [113.290764, 23.131591]], [[113.297704, 23.136864], [113.293653, 23.138646]], [[113.287345, 23.136225], [113.289249, 23.128366]], [[113.278284, 23.130754], [113.283932, 23.125954]], [[113.285691, 23.135127], [113.292448, 23.135155]], [[113.298245, 23.12965], [113.290534, 23.138492]], [[113.29107, 23.130885], [113.299721, 23.136245]], [[113.299024, 23.138495], [113.292235, 23.138753]], [[113.287911, 23.140248], [113.291828, 23.139294]], [[113.281935, 23.131342], [113.285697, 23.131516]], [[113.284088, 23.132153], [113.284811, 23.13855]], [[113.294421, 23.130126], [113.290069, 23.143307]], [[113.285691, 23.13036], [113.290224, 23.139607]], [[113.279334, 23.117565], [113.28063, 23.118623]], [[113.290032, 23.136733], [113.299003, 23.127653]], [[113.294524, 23.125112], [113.292682, 23.128773]], [[113.291375, 23.134754], [113.2979, 23.132264]], [[113.287472, 23.130036], [113.288416, 23.129989]], [[113.285085, 23.129378], [113.291927, 23.131466]], [[113.289954, 23.132731], [113.290589, 23.121882]], [[113.28834, 23.135669], [113.292043, 23.132879]], [[113.288255, 23.127916], [113.293486, 23.130189]], [[113.292507, 23.137616], [113.287447, 23.137258]], [[113.284606, 23.13785], [113.28957, 23.129508]], [[113.293151, 23.136513], [113.299723, 23.131661]], [[113.291769, 23.133723], [113.290883, 23.133855]], [[113.28117, 23.134832], [113.288551, 23.133787]], [[113.297088, 23.136856], [113.295134, 23.136518]], [[113.282452, 23.130191], [113.29229, 23.132566]], [[113.283378, 23.131901], [113.27934, 23.122933]], [[113.282938, 23.14202], [113.291329, 23.137176]], [[113.291359, 23.127683], [113.296275, 23.127377]], [[113.295052, 23.117588], [113.301228, 23.117817]], [[113.282093, 23.131801], [113.286034, 23.129794]], [[113.281759, 23.128881], [113.284599, 23.135366]], [[113.286479, 23.141636], [113.290466, 23.133623]], [[113.289094, 23.139766], [113.298825, 23.137235]], [[113.296271, 23.130344], [113.292864, 23.132371]], [[113.29292, 23.129785], [113.295933, 23.12731]], [[113.285779, 23.137633], [113.288804, 23.134831]], [[113.286893, 23.130399], [113.289947, 23.126365]], [[113.288555, 23.139963], [113.295215, 23.135369]], [[113.294411, 23.133137], [113.293698, 23.129439]], [[113.287065, 23.136422], [113.289606, 23.131901]], [[113.290704, 23.129696], [113.298992, 23.123163]], [[113.286651, 23.131668], [113.284358, 23.12629]], [[113.294738, 23.1339], [113.298534, 23.137169]], [[113.294916, 23.133083], [113.29458, 23.130687]], [[113.284011, 23.135563], [113.289486, 23.132088]], [[113.288075, 23.138265], [113.292578, 23.139578]], [[113.286795, 23.132711], [113.287854, 23.138055]], [[113.284108, 23.129226], [113.279889, 23.13121]], [[113.285019, 23.139327], [113.286644, 23.144435]], [[113.291413, 23.138382], [113.29156, 23.135642]], [[113.291239, 23.129695], [113.293532, 23.135715]], [[113.285853, 23.135642], [113.286113, 23.13135]], [[113.283761, 23.13368], [113.295893, 23.130852]], [[113.28999, 23.141978], [113.29159, 23.133918]], [[113.295329, 23.135204], [113.297756, 23.134193]], [[113.293236, 23.135864], [113.287175, 23.131443]], [[113.28404, 23.140312], [113.29048, 23.139172]], [[113.292323, 23.135212], [113.298387, 23.129857]], [[113.288447, 23.136388], [113.288557, 23.135002]], [[113.289015, 23.129656], [113.290402, 23.126334]], [[113.2818, 23.126182], [113.290369, 23.127663]], [[113.295512, 23.132611], [113.298598, 23.135691]], [[113.287519, 23.135789], [113.289708, 23.133277]], [[113.287734, 23.13416], [113.293702, 23.135313]], [[113.285508, 23.139094], [113.291406, 23.139249]], [[113.298207, 23.120886], [113.303142, 23.129112]], [[113.283276, 23.133325], [113.281644, 23.132295]], [[113.293415, 23.133062], [113.293273, 23.125936]], [[113.283252, 23.137887], [113.293932, 23.137902]], [[113.289691, 23.128825], [113.289291, 23.12117]], [[113.2924, 23.13185], [113.291758, 23.138757]], [[113.292117, 23.13503], [113.29064, 23.125564]], [[113.288453, 23.129876], [113.291022, 23.129396]], [[113.285687, 23.138647], [113.287883, 23.130436]], [[113.28548, 23.128609], [113.278572, 23.128605]], [[113.288214, 23.132692], [113.290798, 23.135271]], [[113.291699, 23.13836], [113.287108, 23.133887]], [[113.286027, 23.133423], [113.28961, 23.12512]], [[113.282502, 23.128015], [113.284361, 23.133999]], [[113.287051, 23.134369], [113.297059, 23.128163]], [[113.290336, 23.135697], [113.299205, 23.140732]], [[113.286929, 23.129708], [113.284027, 23.136877]], [[113.284311, 23.141546], [113.288907, 23.129107]], [[113.28002, 23.124396], [113.283694, 23.124252]], [[113.287421, 23.135755], [113.290105, 23.139239]], [[113.293851, 23.134713], [113.296698, 23.13613]], [[113.289356, 23.126549], [113.287866, 23.129206]], [[113.283375, 23.130107], [113.288973, 23.132984]], [[113.283625, 23.131366], [113.280685, 23.130022]], [[113.28305, 23.138862], [113.280163, 23.145597]], [[113.282472, 23.132397], [113.291843, 23.132385]], [[113.29345, 23.136375], [113.296168, 23.126763]], [[113.289035, 23.139758], [113.285915, 23.137691]], [[113.285592, 23.130104], [113.287163, 23.133054]], [[113.289209, 23.135837], [113.291958, 23.126851]], [[113.289727, 23.127774], [113.288321, 23.125144]], [[113.290223, 23.136176], [113.296206, 23.132225]], [[113.28278, 23.125348], [113.28775, 23.129266]], [[113.294869, 23.133704], [113.303677, 23.13418]], [[113.275579, 23.142658], [113.277411, 23.137137]], [[113.289755, 23.137585], [113.289982, 23.134192]], [[113.282272, 23.139518], [113.290195, 23.133683]], [[113.282946, 23.132916], [113.283068, 23.135376]], [[113.283698, 23.132099], [113.286282, 23.128105]], [[113.281749, 23.123635], [113.293026, 23.131719]], [[113.291079, 23.128681], [113.295667, 23.128164]], [[113.293675, 23.132196], [113.290194, 23.130289]], [[113.288018, 23.136963], [113.285455, 23.132907]], [[113.282337, 23.131839], [113.279718, 23.138502]], [[113.291448, 23.135714], [113.293375, 23.132503]], [[113.283815, 23.135837], [113.285421, 23.127377]], [[113.281261, 23.134299], [113.285524, 23.130053]], [[113.289008, 23.133482], [113.287554, 23.131434]], [[113.282862, 23.143206], [113.285668, 23.132508]], [[113.287169, 23.1304], [113.280933, 23.12963]], [[113.28539, 23.119184], [113.289651, 23.12825]], [[113.292463, 23.134224], [113.295136, 23.138113]], [[113.279418, 23.135834], [113.284251, 23.134708]], [[113.285565, 23.125462], [113.290072, 23.13164]], [[113.286687, 23.137665], [113.286911, 23.137967]], [[113.290279, 23.130648], [113.291845, 23.132856]], [[113.300873, 23.116095], [113.300066, 23.11092]], [[113.289662, 23.133861], [113.288483, 23.139305]], [[113.285432, 23.13515], [113.281075, 23.135306]], [[113.287686, 23.131313], [113.285743, 23.130791]], [[113.282621, 23.129068], [113.290418, 23.136747]], [[113.285818, 23.135547], [113.288646, 23.132025]], [[113.289581, 23.139495], [113.289273, 23.125501]], [[113.294748, 23.137543], [113.302386, 23.130738]], [[113.297126, 23.141748], [113.295554, 23.136896]], [[113.285709, 23.138931], [113.284075, 23.144075]], [[113.290085, 23.138219], [113.291668, 23.13714]], [[113.283292, 23.129984], [113.289128, 23.129207]], [[113.285947, 23.137608], [113.290064, 23.133641]], [[113.295531, 23.138056], [113.292773, 23.13383]], [[113.288692, 23.127805], [113.287451, 23.129906]], [[113.295831, 23.133586], [113.293222, 23.137251]], [[113.292059, 23.121667], [113.296496, 23.124597]], [[113.29926, 23.127343], [113.295715, 23.128033]], [[113.282501, 23.129378], [113.284785, 23.13341]], [[113.289771, 23.126932], [113.293343, 23.129991]], [[113.288457, 23.131782], [113.287532, 23.133893]], [[113.286486, 23.145566], [113.288362, 23.15265]], [[113.284837, 23.131467], [113.286114, 23.123142]], [[113.288575, 23.147014], [113.293133, 23.14496]], [[113.29755, 23.129225], [113.293469, 23.133254]], [[113.285204, 23.134658], [113.290352, 23.132294]], [[113.289556, 23.136371], [113.291102, 23.130406]], [[113.287088, 23.130704], [113.290761, 23.128839]], [[113.276942, 23.129746], [113.281101, 23.130346]], [[113.286816, 23.133438], [113.292353, 23.134065]], [[113.280348, 23.135588], [113.284858, 23.127898]], [[113.289193, 23.140839], [113.28761, 23.134095]], [[113.290585, 23.138847], [113.287699, 23.129986]], [[113.284514, 23.12225], [113.287658, 23.123923]], [[113.288444, 23.137794], [113.289321, 23.135136]], [[113.288917, 23.132418], [113.282555, 23.125333]], [[113.290412, 23.13161], [113.292068, 23.128074]], [[113.293798, 23.133992], [113.291136, 23.129214]], [[113.292957, 23.129443], [113.296296, 23.127529]], [[113.285468, 23.129145], [113.289095, 23.123022]], [[113.293015, 23.126603], [113.290707, 23.131522]], [[113.289463, 23.131049], [113.284208, 23.134954]], [[113.296135, 23.13077], [113.297481, 23.128316]], [[113.287932, 23.132676], [113.29151, 23.131432]], [[113.284913, 23.134235], [113.282817, 23.128513]], [[113.288145, 23.130157], [113.291009, 23.132565]], [[113.285686, 23.138937], [113.286846, 23.13773]], [[113.285364, 23.131666], [113.293185, 23.131229]], [[113.281796, 23.122508], [113.29139, 23.127946]], [[113.297502, 23.133706], [113.29499, 23.134684]], [[113.291874, 23.13395], [113.292398, 23.132053]], [[113.293847, 23.140754], [113.296914, 23.137286]], [[113.284844, 23.140508], [113.286555, 23.136478]], [[113.287555, 23.130349], [113.285428, 23.13166]], [[113.293616, 23.131717], [113.295884, 23.123722]], [[113.288565, 23.132516], [113.289328, 23.139055]], [[113.281023, 23.137746], [113.284885, 23.140333]], [[113.28824, 23.129409], [113.295431, 23.138177]], [[113.295746, 23.138084], [113.298944, 23.137754]], [[113.294117, 23.125698], [113.296015, 23.125833]], [[113.300168, 23.129377], [113.296294, 23.1269]], [[113.288541, 23.136951], [113.285989, 23.134285]], [[113.292013, 23.133995], [113.284453, 23.134175]], [[113.291101, 23.128661], [113.296568, 23.130304]], [[113.290047, 23.128753], [113.295647, 23.136613]], [[113.288804, 23.129598], [113.29252, 23.124815]], [[113.286355, 23.127583], [113.283672, 23.127454]], [[113.297333, 23.130904], [113.3058, 23.132775]], [[113.288657, 23.122515], [113.288187, 23.12165]], [[113.290051, 23.116424], [113.292362, 23.128869]], [[113.28574, 23.137683], [113.287256, 23.131333]]]
    //线构造函数
    function MakeLineFnc([...positionArr]) {
      this.geometry = {
        "type": "LineString",
        "coordinates": [...positionArr]
      }
    }
    // 点构造函数
    function MakeSpotFnc([...spotArr]) {
      this.geometry = {
        "type": "Point",
        "coordinates": [...spotArr]
      }
    }

    for (const line of allLine) {
      finalLine.push(new MakeLineFnc(line))
      finalSpot.push(new MakeSpotFnc(line[0]))
      finalSpot.push(new MakeSpotFnc(line[1]))
      console.log(finalLine);
    }


    let line1 = new MakeLineFnc([[113.220777, 23.147829], [113.249007, 23.128932]]);

    // 进入北京方向的线
    var LineSource = new window.Loca.GeoJSONSource({
      // url: 'https://a.amap.com/Loca/static/loca-v2/demos/mock_data/data-line-in.json',
      data: {
        "type": "FeatureCollection",
        "features": finalLine
      }
    });
    var Linelayer = new window.Loca.PulseLineLayer({
      // loca,
      zIndex: 11,
      opacity: 1,
      visible: true,
      zooms: [2, 22],
    });

    Linelayer.setStyle({
      altitude: 0,
      lineWidth: (_, feature) => 2,
      headColor: (_, feature) => headColors[2],
      trailColor: (_, feature) => trailColors[2],
      interval: 0.5,
      duration: 5000,
    });
    Linelayer.setSource(LineSource);
    loca.add(Linelayer);

    // 下方呼吸点层
    var scatter = new window.Loca.ScatterLayer({
      // loca,
      zIndex: 10,
      opacity: 0.5,
      visible: true,
      zooms: [2, 22],
    });
    var scatterGeo = new window.Loca.GeoJSONSource({
      data: {
        "type": "FeatureCollection",
        "features": finalSpot
      }
    });
    scatter.setSource(scatterGeo);
    scatter.setStyle({
      unit: 'px',
      size: (_, feature) => {
        var size = 20;
        return [size, size];
      },
      borderWidth: 0,
      texture: 'https://a.amap.com/Loca/static/loca-v2/demos/images/breath_yellow.png',
      duration: 2000,
      animate: true,
    });
    loca.add(scatter)

    loca.animate.start();

    window.AMapUI.load(['ui/misc/PathSimplifier', 'lib/$'], function (PathSimplifier, $) {

      if (!PathSimplifier.supportCanvas) {
        alert('当前环境不支持 Canvas！');
        return;
      }

      var pathSimplifierIns = new PathSimplifier({
        zIndex: 100,
        // zoom:,
        //autoSetFitView:false,
        map: map, //所属的地图实例

        getPath: function (pathData, pathIndex) {

          return pathData.path;
        },
        getHoverTitle: function (pathData, pathIndex, pointIndex) {
          return '主流向';
        },
        renderOptions: {

          renderAllPointsIfNumberBelow: 100 //绘制路线节点，如不需要可设置为-1
        }
      });

      window.pathSimplifierIns = pathSimplifierIns;

      //设置数据
      pathSimplifierIns.setData([{
        name: '路线0',
        path: [
          [113.38999999999999, 22.804000000000002], [113.34968457761818, 22.83901862375142], [113.36375480525814, 22.830950506765213], [113.36853402651826, 22.829051371101514], [113.36960990699914, 22.831273877095725], [113.37036036251772, 22.832824134692203], [113.35556571298739, 22.84166295755054], [113.37605404461937, 22.82976298646743], [113.38103003542437, 22.829015144332857], [113.36319869914294, 22.83945921284365], [113.36262423788955, 22.840296811215026], [113.37080948493167, 22.835666858673797], [113.3693233908572, 22.836759537899965]
        ]
      }]);

    })
  }

  render() {
    return (
      <div ref="container" style={{ width: "80%", height: "100%" }}></div>
    )
  }
}
